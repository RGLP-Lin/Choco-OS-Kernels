;This kernel is 16 BIT ONLY
BITS 16
ORG 0x7C00

; Print message
mov si, msg
mov ah, 0x0e
.print:
    lodsb
    or al, al
    jz .wait
    int 0x10
    jmp .print

; Wait for about 0.5 seconds (using ~9 BIOS timer ticks, each ~55ms)
.wait:
    mov cx, 9         ; About 22 ticks ~ 2s
.wait_tick:
    push cx
    call wait_bios_tick
    pop cx
    loop .wait_tick

; Clear screen using BIOS INT 10, AH=06h (scroll up entire window)
    mov ah, 0x06      ; Scroll up
    mov al, 0         ; Entire window
    mov bh, 0x07      ; Attribute (grey on black)
    mov cx, 0         ; Upper left corner (row=0, col=0)
    mov dx, 0x184F    ; Lower right corner (row=24, col=79)
    int 0x10

; Boot kernel
    jmp 0x1000

; ----------------------------------
; Subroutine: wait_bios_tick
; Waits for ONE BIOS timer tick (about 55ms)
wait_bios_tick:
    pusha
    mov ah, 0     ; Get system timer
    int 0x1A
    mov bx, dx    ; Save tick count
.wait_for_next:
    mov ah, 0
    int 0x1A
    cmp dx, bx
    je .wait_for_next
    popa
    ret

msg db "Booting Chocolate OS Shell...", 0

; DONT TOUCH ANYTHING BELOW THIS!!! IT LETS THE 16 BIT CPU BOOT THE KERNEL/OS
times 510-($-$$) db 0
dw 0xAA55
